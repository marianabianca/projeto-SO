#!/bin/bash

#simulation output format
#fault_counter num_pages num_frames alg clock

#plot input format
#nfaults,nframes,alg
#15000,6,opt

# Note that this script expects that we have related file in the output directory. For example, we cannot mix
# output generated from different input files in output directory.

for d in `find output/* -type d`
do
    echo $f
    allsamples="output/`basename $d`.mem.plot"
    # EDIT (JÃºlio) nfaults npages nframes alg clock tlb_size io tlb_count
    echo "nfaults,nframes,alg,tlb_size,io,tlb_count" > $allsamples
    cat $d/*out | cut -d" " -f1,3,4,6,7,8 | sed 's/ /\,/g' >> $allsamples
    Rscript plot.r $allsamples
done
